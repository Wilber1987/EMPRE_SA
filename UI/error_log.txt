[5/24/2025 10:48:12 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:48:12 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:48:12 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:48:12 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:48:12 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:48:12 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:48:12 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:48:12 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:07 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:52:07 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:07 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:52:07 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:07 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:52:07 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:07 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:52:07 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:15 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:52:15 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:15 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:52:15 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:15 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:52:15 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:52:15 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:52:15 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:54:43 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:54:43 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:54:43 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:54:43 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:54:43 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:54:43 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:55:25 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:55:25 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:56:36 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:56:36 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:56:36 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:56:36 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:56:36 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:56:36 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:56:42 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:56:42 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:58:52 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:58:52 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:58:52 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 10:58:52 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:58:52 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 10:58:52 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 10:58:54 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 10:58:54 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:01:54 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 11:01:54 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:01:54 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 11:01:54 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:01:54 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 11:01:54 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:02:07 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 11:02:07 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)
   at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:04:05 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 11:04:05 AM] Failed to log error to the database: Implicit distributed transactions have not been enabled. If you're intentionally starting a distributed transaction, set TransactionManager.ImplicitDistributedTransactions to true.
   at System.Transactions.DtcProxyShim.DtcProxyShimFactory.ConnectToProxy(String nodeName, Guid resourceManagerIdentifier, Object managedIdentifier, Boolean& nodeNameMatches, Byte[]& whereabouts, ResourceManagerShim& resourceManagerShim)
   at System.Transactions.Oletx.DtcTransactionManager.Initialize()
   at System.Transactions.Oletx.DtcTransactionManager.get_ProxyShimFactory()
   at System.Transactions.TransactionInterop.GetOletxTransactionFromTransmitterPropagationToken(Byte[] propagationToken)
   at System.Transactions.TransactionStatePSPEOperation.PSPEPromote(InternalTransaction tx)
   at System.Transactions.TransactionStateDelegatedBase.EnterState(InternalTransaction tx)
   at System.Transactions.EnlistableStates.Promote(InternalTransaction tx)
   at System.Transactions.Transaction.Promote()
   at System.Transactions.TransactionInterop.ConvertToOletxTransaction(Transaction transaction)
   at System.Transactions.TransactionInterop.GetExportCookie(Transaction transaction, Byte[] whereabouts)
   at System.Data.SqlClient.SqlInternalConnection.GetTransactionCookie(Transaction transaction, Byte[] whereAbouts)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:04:05 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/24/2025 11:04:05 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:04:27 AM] Failed to log true error to file: Failed to convert parameter value from a Transactional_Valoracion to a String.
   at System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming)
   at System.Data.SqlClient.SqlParameter.GetCoercedValue()
   at System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)
   at System.Data.SqlClient.SqlCommand.BuildParamList(TdsParser parser, SqlParameterCollection parameters)
   at System.Data.SqlClient.SqlCommand.BuildExecuteSql(CommandBehavior behavior, String commandText, SqlParameterCollection parameters, _SqlRPC& rpc)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.UpdateObject(EntityClass entity, String[] IdObject) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 335
   at APPCORE.EntityClass.Update(String[] Id) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 269
[5/24/2025 11:04:27 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/24/2025 11:04:29 AM] Failed to log true error to file: The transaction associated with the current connection has completed but has not been disposed.  The transaction must be disposed before the connection can be used to execute SQL statements.
   at System.Data.SqlClient.SqlInternalConnectionTds.CheckEnlistedTransactionBinding()
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalTransaction.Rollback()
   at System.Data.SqlClient.SqlTransaction.Rollback()
   at APPCORE.EntityClass.Update() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 221
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 122
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.SaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 19
[5/24/2025 11:04:29 AM] Failed to log error to the database: The operation is not valid for the state of the transaction.
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Guid promoterType)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionPool.PrepareConnection(DbConnection owningObject, DbConnectionInternal obj, Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at System.Data.SqlClient.SqlConnection.Open()
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 169
   at APPCORE.LoggerServices.AddMessageError(String message, Exception ex) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\LoggerServices.cs:line 77
[5/25/2025 4:26:29 PM] ERROR: Max retries reached. Operation failed.: Must declare the scalar variable "@EstadoPWY_Q_I_L".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:26:29 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoPWY_Q_I_L".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:26:29 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoPWY_Q_I_L".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:26:29 PM] ERROR: BuildTable 

 Tbl_Factura 

  
 SELECT  Id_Factura,Tipo,Concepto,Forma_Pago,Direccion_Envio,Id_Cliente,Id_Sucursal,Id_User,Fecha,Fecha_Vencimiento,Observaciones,Id_Usuario,Estado,Moneda,Sub_Total,TotalDescuento,Iva,Tasa_Cambio,Tasa_Cambio_Venta,Total,Total_Pagado,Total_Financiado,Motivo_Anulacion, Datos = JSON_QUERY(Datos), Datos_Financiamiento = JSON_QUERY(Datos_Financiamiento),Cliente = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion,Catalogo_Nacionalidad = JSON_QUERY((SELECT  id_nacionalidad,nombre,nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Nacionalidad as UFU_H_N_R   WHERE   id_nacionalidad = YKP_F_L_X.id_nacionalidad  ORDER BY id_nacionalidad DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Departamento as YKP_F_L_X   WHERE   id_departamento = RFL_K_M_E.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as BGZ_Z_I_W   WHERE   id_departamento = RAB_Z_L_Z.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Municipio as RAB_Z_L_Z   WHERE   id_municipio = RFL_K_M_E.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Profesiones = JSON_QUERY((SELECT  id_profesion,nombre FROM dbo.Catalogo_Profesiones as QJH_V_I_P   WHERE   id_profesion = RFL_K_M_E.id_profesion  ORDER BY id_profesion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Tipo_Identificacion = JSON_QUERY((SELECT  id_tipo_identificacion,Descripcion,Estado FROM dbo.Catalogo_Tipo_Identificacion as MPQ_A_D_V   WHERE   id_tipo_identificacion = RFL_K_M_E.id_tipo_identificacion  ORDER BY id_tipo_identificacion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Condicion_Laboral_Cliente = (SELECT  id,id_cliente,fecha_ingreso,ocupacion_cargo,ingresos_mensuales,direccion,id_municipio,id_departamento,nombre_empresa,Catalogo_Clientes = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular FROM dbo.Catalogo_Clientes as MSJ_J_S_V   WHERE   codigo_cliente = BOZ_X_K_S.id_cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as GEI_R_G_Z   WHERE   id_departamento = BOZ_X_K_S.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento FROM dbo.Catalogo_Municipio as YOJ_K_D_N   WHERE   id_municipio = BOZ_X_K_S.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Condicion_Laboral_Cliente as BOZ_X_K_S   WHERE   id_cliente = RFL_K_M_E.codigo_cliente  ORDER BY id DESC FOR JSON PATH) FROM dbo.Catalogo_Clientes as RFL_K_M_E   WHERE   codigo_cliente = MPU_L_M_O.Id_Cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Factura = (SELECT  Id_DetalleFactura,Id_Factura,Id_Producto,Cantidad,Precio_Venta,Iva,Total,Id_Lote,Descuento,Sub_Total,Monto_Descuento,Lote = JSON_QUERY((SELECT  Id_Lote,Id_Producto,Precio_Venta,Precio_Compra,Cantidad_Inicial,Cantidad_Existente,Id_Sucursal,Id_User,Fecha_Ingreso,Id_Almacen,Lote,Id_Detalle_Compra,Detalles, Datos_Producto = JSON_QUERY(Datos_Producto), EtiquetaLote = JSON_QUERY(EtiquetaLote),Cat_Almacenes = JSON_QUERY((SELECT  Id_Almacen,Descripcion,Estado,Id_Sucursal FROM facturacion.Cat_Almacenes as ZIC_B_C_M   WHERE   Id_Almacen = XLU_B_P_R.Id_Almacen  ORDER BY Id_Almacen DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Compra = JSON_QUERY((SELECT  Id_Detalle_Compra,Id_Compra,Id_Producto,Cantidad,Precio_Unitario,SubTotal,Iva,Total,Presentacion FROM facturacion.Detalle_Compra as GCH_W_R_P   WHERE   Id_Detalle_Compra = XLU_B_P_R.Id_Detalle_Compra  ORDER BY Id_Detalle_Compra DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Estado FROM facturacion.Tbl_Lotes as XLU_B_P_R   WHERE Estado = @EstadoPWY_Q_I_L  AND   Id_Lote = XXJ_B_M_M.Id_Lote  ORDER BY Id_Lote DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM facturacion.Detalle_Factura as XXJ_B_M_M   WHERE   Id_Factura = MPU_L_M_O.Id_Factura  ORDER BY Id_DetalleFactura DESC FOR JSON PATH) FROM facturacion.Tbl_Factura as MPU_L_M_O     ORDER BY Id_Factura DESC: Must declare the scalar variable "@EstadoPWY_Q_I_L".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:26:47 PM] ERROR: Max retries reached. Operation failed.: Must declare the scalar variable "@EstadoDAH_K_I_B".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:26:47 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoDAH_K_I_B".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:26:47 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoDAH_K_I_B".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:26:47 PM] ERROR: BuildTable 

 Tbl_Factura 

  
 SELECT  Id_Factura,Tipo,Concepto,Forma_Pago,Direccion_Envio,Id_Cliente,Id_Sucursal,Id_User,Fecha,Fecha_Vencimiento,Observaciones,Id_Usuario,Estado,Moneda,Sub_Total,TotalDescuento,Iva,Tasa_Cambio,Tasa_Cambio_Venta,Total,Total_Pagado,Total_Financiado,Motivo_Anulacion, Datos = JSON_QUERY(Datos), Datos_Financiamiento = JSON_QUERY(Datos_Financiamiento),Cliente = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion,Catalogo_Nacionalidad = JSON_QUERY((SELECT  id_nacionalidad,nombre,nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Nacionalidad as ZUQ_Z_W_L   WHERE   id_nacionalidad = KXT_X_T_M.id_nacionalidad  ORDER BY id_nacionalidad DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Departamento as KXT_X_T_M   WHERE   id_departamento = JHS_B_L_H.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as LSO_W_S_Q   WHERE   id_departamento = TET_G_D_I.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Municipio as TET_G_D_I   WHERE   id_municipio = JHS_B_L_H.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Profesiones = JSON_QUERY((SELECT  id_profesion,nombre FROM dbo.Catalogo_Profesiones as TZY_R_S_L   WHERE   id_profesion = JHS_B_L_H.id_profesion  ORDER BY id_profesion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Tipo_Identificacion = JSON_QUERY((SELECT  id_tipo_identificacion,Descripcion,Estado FROM dbo.Catalogo_Tipo_Identificacion as QGL_Z_Z_V   WHERE   id_tipo_identificacion = JHS_B_L_H.id_tipo_identificacion  ORDER BY id_tipo_identificacion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Condicion_Laboral_Cliente = (SELECT  id,id_cliente,fecha_ingreso,ocupacion_cargo,ingresos_mensuales,direccion,id_municipio,id_departamento,nombre_empresa,Catalogo_Clientes = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular FROM dbo.Catalogo_Clientes as UFW_W_N_F   WHERE   codigo_cliente = NDR_C_O_F.id_cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as BCS_V_Z_N   WHERE   id_departamento = NDR_C_O_F.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento FROM dbo.Catalogo_Municipio as KKM_E_S_U   WHERE   id_municipio = NDR_C_O_F.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Condicion_Laboral_Cliente as NDR_C_O_F   WHERE   id_cliente = JHS_B_L_H.codigo_cliente  ORDER BY id DESC FOR JSON PATH) FROM dbo.Catalogo_Clientes as JHS_B_L_H   WHERE   codigo_cliente = QVD_D_B_W.Id_Cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Factura = (SELECT  Id_DetalleFactura,Id_Factura,Id_Producto,Cantidad,Precio_Venta,Iva,Total,Id_Lote,Descuento,Sub_Total,Monto_Descuento,Lote = JSON_QUERY((SELECT  Id_Lote,Id_Producto,Precio_Venta,Precio_Compra,Cantidad_Inicial,Cantidad_Existente,Id_Sucursal,Id_User,Fecha_Ingreso,Id_Almacen,Lote,Id_Detalle_Compra,Detalles, Datos_Producto = JSON_QUERY(Datos_Producto), EtiquetaLote = JSON_QUERY(EtiquetaLote),Cat_Almacenes = JSON_QUERY((SELECT  Id_Almacen,Descripcion,Estado,Id_Sucursal FROM facturacion.Cat_Almacenes as ZPI_F_V_K   WHERE   Id_Almacen = UMT_G_N_D.Id_Almacen  ORDER BY Id_Almacen DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Compra = JSON_QUERY((SELECT  Id_Detalle_Compra,Id_Compra,Id_Producto,Cantidad,Precio_Unitario,SubTotal,Iva,Total,Presentacion FROM facturacion.Detalle_Compra as VYX_I_D_E   WHERE   Id_Detalle_Compra = UMT_G_N_D.Id_Detalle_Compra  ORDER BY Id_Detalle_Compra DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Estado FROM facturacion.Tbl_Lotes as UMT_G_N_D   WHERE Estado = @EstadoDAH_K_I_B  AND   Id_Lote = PEU_D_L_N.Id_Lote  ORDER BY Id_Lote DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM facturacion.Detalle_Factura as PEU_D_L_N   WHERE   Id_Factura = QVD_D_B_W.Id_Factura  ORDER BY Id_DetalleFactura DESC FOR JSON PATH) FROM facturacion.Tbl_Factura as QVD_D_B_W     ORDER BY Id_Factura DESC: Must declare the scalar variable "@EstadoDAH_K_I_B".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:27:10 PM] ERROR: Max retries reached. Operation failed.: Must declare the scalar variable "@EstadoFDB_U_A_V".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:27:10 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoFDB_U_A_V".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:27:10 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoFDB_U_A_V".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:27:10 PM] ERROR: BuildTable 

 Tbl_Factura 

  
 SELECT  Id_Factura,Tipo,Concepto,Forma_Pago,Direccion_Envio,Id_Cliente,Id_Sucursal,Id_User,Fecha,Fecha_Vencimiento,Observaciones,Id_Usuario,Estado,Moneda,Sub_Total,TotalDescuento,Iva,Tasa_Cambio,Tasa_Cambio_Venta,Total,Total_Pagado,Total_Financiado,Motivo_Anulacion, Datos = JSON_QUERY(Datos), Datos_Financiamiento = JSON_QUERY(Datos_Financiamiento),Cliente = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion,Catalogo_Nacionalidad = JSON_QUERY((SELECT  id_nacionalidad,nombre,nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Nacionalidad as FOA_Q_H_S   WHERE   id_nacionalidad = VWS_O_Q_S.id_nacionalidad  ORDER BY id_nacionalidad DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Departamento as VWS_O_Q_S   WHERE   id_departamento = BZY_D_V_B.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as FIW_Z_B_V   WHERE   id_departamento = XEW_N_D_Z.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Municipio as XEW_N_D_Z   WHERE   id_municipio = BZY_D_V_B.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Profesiones = JSON_QUERY((SELECT  id_profesion,nombre FROM dbo.Catalogo_Profesiones as QLE_V_X_C   WHERE   id_profesion = BZY_D_V_B.id_profesion  ORDER BY id_profesion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Tipo_Identificacion = JSON_QUERY((SELECT  id_tipo_identificacion,Descripcion,Estado FROM dbo.Catalogo_Tipo_Identificacion as WAP_K_O_Q   WHERE   id_tipo_identificacion = BZY_D_V_B.id_tipo_identificacion  ORDER BY id_tipo_identificacion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Condicion_Laboral_Cliente = (SELECT  id,id_cliente,fecha_ingreso,ocupacion_cargo,ingresos_mensuales,direccion,id_municipio,id_departamento,nombre_empresa,Catalogo_Clientes = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular FROM dbo.Catalogo_Clientes as KYF_Y_X_V   WHERE   codigo_cliente = DPM_T_H_A.id_cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as HMJ_W_R_C   WHERE   id_departamento = DPM_T_H_A.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento FROM dbo.Catalogo_Municipio as AJE_P_K_A   WHERE   id_municipio = DPM_T_H_A.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Condicion_Laboral_Cliente as DPM_T_H_A   WHERE   id_cliente = BZY_D_V_B.codigo_cliente  ORDER BY id DESC FOR JSON PATH) FROM dbo.Catalogo_Clientes as BZY_D_V_B   WHERE   codigo_cliente = XNM_D_M_U.Id_Cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Factura = (SELECT  Id_DetalleFactura,Id_Factura,Id_Producto,Cantidad,Precio_Venta,Iva,Total,Id_Lote,Descuento,Sub_Total,Monto_Descuento,Lote = JSON_QUERY((SELECT  Id_Lote,Id_Producto,Precio_Venta,Precio_Compra,Cantidad_Inicial,Cantidad_Existente,Id_Sucursal,Id_User,Fecha_Ingreso,Id_Almacen,Lote,Id_Detalle_Compra,Detalles, Datos_Producto = JSON_QUERY(Datos_Producto), EtiquetaLote = JSON_QUERY(EtiquetaLote),Cat_Almacenes = JSON_QUERY((SELECT  Id_Almacen,Descripcion,Estado,Id_Sucursal FROM facturacion.Cat_Almacenes as JIF_M_H_X   WHERE   Id_Almacen = GUZ_P_K_D.Id_Almacen  ORDER BY Id_Almacen DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Compra = JSON_QUERY((SELECT  Id_Detalle_Compra,Id_Compra,Id_Producto,Cantidad,Precio_Unitario,SubTotal,Iva,Total,Presentacion FROM facturacion.Detalle_Compra as GDW_G_T_B   WHERE   Id_Detalle_Compra = GUZ_P_K_D.Id_Detalle_Compra  ORDER BY Id_Detalle_Compra DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Estado FROM facturacion.Tbl_Lotes as GUZ_P_K_D   WHERE Estado = @EstadoFDB_U_A_V  AND   Id_Lote = OTL_N_D_S.Id_Lote  ORDER BY Id_Lote DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM facturacion.Detalle_Factura as OTL_N_D_S   WHERE   Id_Factura = XNM_D_M_U.Id_Factura  ORDER BY Id_DetalleFactura DESC FOR JSON PATH) FROM facturacion.Tbl_Factura as XNM_D_M_U     ORDER BY Id_Factura DESC: Must declare the scalar variable "@EstadoFDB_U_A_V".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:27:54 PM] ERROR: Max retries reached. Operation failed.: Must declare the scalar variable "@EstadoAGR_Q_K_P".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:27:54 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoAGR_Q_K_P".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:27:54 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoAGR_Q_K_P".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:27:54 PM] ERROR: BuildTable 

 Tbl_Factura 

  
 SELECT  Id_Factura,Tipo,Concepto,Forma_Pago,Direccion_Envio,Id_Cliente,Id_Sucursal,Id_User,Fecha,Fecha_Vencimiento,Observaciones,Id_Usuario,Estado,Moneda,Sub_Total,TotalDescuento,Iva,Tasa_Cambio,Tasa_Cambio_Venta,Total,Total_Pagado,Total_Financiado,Motivo_Anulacion, Datos = JSON_QUERY(Datos), Datos_Financiamiento = JSON_QUERY(Datos_Financiamiento),Cliente = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion,Catalogo_Nacionalidad = JSON_QUERY((SELECT  id_nacionalidad,nombre,nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Nacionalidad as YIV_W_Q_N   WHERE   id_nacionalidad = VUU_C_V_W.id_nacionalidad  ORDER BY id_nacionalidad DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Departamento as VUU_C_V_W   WHERE   id_departamento = DZT_B_S_F.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as CVO_Y_U_A   WHERE   id_departamento = LLV_V_K_B.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Municipio as LLV_V_K_B   WHERE   id_municipio = DZT_B_S_F.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Profesiones = JSON_QUERY((SELECT  id_profesion,nombre FROM dbo.Catalogo_Profesiones as PJK_E_S_H   WHERE   id_profesion = DZT_B_S_F.id_profesion  ORDER BY id_profesion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Tipo_Identificacion = JSON_QUERY((SELECT  id_tipo_identificacion,Descripcion,Estado FROM dbo.Catalogo_Tipo_Identificacion as DVD_G_S_M   WHERE   id_tipo_identificacion = DZT_B_S_F.id_tipo_identificacion  ORDER BY id_tipo_identificacion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Condicion_Laboral_Cliente = (SELECT  id,id_cliente,fecha_ingreso,ocupacion_cargo,ingresos_mensuales,direccion,id_municipio,id_departamento,nombre_empresa,Catalogo_Clientes = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular FROM dbo.Catalogo_Clientes as AUJ_P_O_H   WHERE   codigo_cliente = HRC_Y_I_U.id_cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as JZW_Y_S_V   WHERE   id_departamento = HRC_Y_I_U.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento FROM dbo.Catalogo_Municipio as BGV_U_W_R   WHERE   id_municipio = HRC_Y_I_U.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Condicion_Laboral_Cliente as HRC_Y_I_U   WHERE   id_cliente = DZT_B_S_F.codigo_cliente  ORDER BY id DESC FOR JSON PATH) FROM dbo.Catalogo_Clientes as DZT_B_S_F   WHERE   codigo_cliente = KXH_W_J_S.Id_Cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Factura = (SELECT  Id_DetalleFactura,Id_Factura,Id_Producto,Cantidad,Precio_Venta,Iva,Total,Id_Lote,Descuento,Sub_Total,Monto_Descuento,Lote = JSON_QUERY((SELECT  Id_Lote,Id_Producto,Precio_Venta,Precio_Compra,Cantidad_Inicial,Cantidad_Existente,Id_Sucursal,Id_User,Fecha_Ingreso,Id_Almacen,Lote,Id_Detalle_Compra,Detalles, Datos_Producto = JSON_QUERY(Datos_Producto), EtiquetaLote = JSON_QUERY(EtiquetaLote),Cat_Almacenes = JSON_QUERY((SELECT  Id_Almacen,Descripcion,Estado,Id_Sucursal FROM facturacion.Cat_Almacenes as OPP_X_U_G   WHERE   Id_Almacen = UKN_Y_Q_L.Id_Almacen  ORDER BY Id_Almacen DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Compra = JSON_QUERY((SELECT  Id_Detalle_Compra,Id_Compra,Id_Producto,Cantidad,Precio_Unitario,SubTotal,Iva,Total,Presentacion FROM facturacion.Detalle_Compra as LBW_I_B_L   WHERE   Id_Detalle_Compra = UKN_Y_Q_L.Id_Detalle_Compra  ORDER BY Id_Detalle_Compra DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Estado FROM facturacion.Tbl_Lotes as UKN_Y_Q_L   WHERE Estado = @EstadoAGR_Q_K_P  AND   Id_Lote = BDD_Q_A_O.Id_Lote  ORDER BY Id_Lote DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM facturacion.Detalle_Factura as BDD_Q_A_O   WHERE   Id_Factura = KXH_W_J_S.Id_Factura  ORDER BY Id_DetalleFactura DESC FOR JSON PATH) FROM facturacion.Tbl_Factura as KXH_W_J_S     ORDER BY Id_Factura DESC: Must declare the scalar variable "@EstadoAGR_Q_K_P".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:28:37 PM] ERROR: Max retries reached. Operation failed.: Must declare the scalar variable "@EstadoQXR_H_O_D".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:28:37 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoQXR_H_O_D".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 4:28:37 PM] Transaction failed and connection restarted.: Must declare the scalar variable "@EstadoQXR_H_O_D".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 4:28:37 PM] ERROR: BuildTable 

 Tbl_Factura 

  
 SELECT  Id_Factura,Tipo,Concepto,Forma_Pago,Direccion_Envio,Id_Cliente,Id_Sucursal,Id_User,Fecha,Fecha_Vencimiento,Observaciones,Id_Usuario,Estado,Moneda,Sub_Total,TotalDescuento,Iva,Tasa_Cambio,Tasa_Cambio_Venta,Total,Total_Pagado,Total_Financiado,Motivo_Anulacion, Datos = JSON_QUERY(Datos), Datos_Financiamiento = JSON_QUERY(Datos_Financiamiento),Cliente = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion,Catalogo_Nacionalidad = JSON_QUERY((SELECT  id_nacionalidad,nombre,nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Nacionalidad as OUF_N_S_V   WHERE   id_nacionalidad = IGX_N_T_R.id_nacionalidad  ORDER BY id_nacionalidad DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Departamento as IGX_N_T_R   WHERE   id_departamento = MNV_Z_M_P.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento,Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as YNI_Z_N_N   WHERE   id_departamento = VVT_U_Y_G.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Catalogo_Municipio as VVT_U_Y_G   WHERE   id_municipio = MNV_Z_M_P.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Profesiones = JSON_QUERY((SELECT  id_profesion,nombre FROM dbo.Catalogo_Profesiones as MUA_Y_B_T   WHERE   id_profesion = MNV_Z_M_P.id_profesion  ORDER BY id_profesion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Tipo_Identificacion = JSON_QUERY((SELECT  id_tipo_identificacion,Descripcion,Estado FROM dbo.Catalogo_Tipo_Identificacion as FCY_J_D_Q   WHERE   id_tipo_identificacion = MNV_Z_M_P.id_tipo_identificacion  ORDER BY id_tipo_identificacion DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Condicion_Laboral_Cliente = (SELECT  id,id_cliente,fecha_ingreso,ocupacion_cargo,ingresos_mensuales,direccion,id_municipio,id_departamento,nombre_empresa,Catalogo_Clientes = JSON_QUERY((SELECT  codigo_cliente,primer_nombre,segundo_nombre,primer_apellido,segundo_apellidio,id_tipo_identificacion,identificacion,sexo,fecha_nacimiento,id_profesion,id_departamento,id_municipio,correo,telefono,direccion,fecha,observaciones,estado_civil,tipo_firma,operadora_celular FROM dbo.Catalogo_Clientes as ZYJ_M_I_M   WHERE   codigo_cliente = ERE_G_M_C.id_cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Departamento = JSON_QUERY((SELECT  id_departamento,nombre,id_nacionalidad,ponderacion,puntaje,clasificacion FROM dbo.Catalogo_Departamento as CPK_N_K_L   WHERE   id_departamento = ERE_G_M_C.id_departamento  ORDER BY id_departamento DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Catalogo_Municipio = JSON_QUERY((SELECT  id_municipio,nombre,id_departamento FROM dbo.Catalogo_Municipio as CRC_I_D_N   WHERE   id_municipio = ERE_G_M_C.id_municipio  ORDER BY id_municipio DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM dbo.Condicion_Laboral_Cliente as ERE_G_M_C   WHERE   id_cliente = MNV_Z_M_P.codigo_cliente  ORDER BY id DESC FOR JSON PATH) FROM dbo.Catalogo_Clientes as MNV_Z_M_P   WHERE   codigo_cliente = VYD_T_J_Y.Id_Cliente  ORDER BY codigo_cliente DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Factura = (SELECT  Id_DetalleFactura,Id_Factura,Id_Producto,Cantidad,Precio_Venta,Iva,Total,Id_Lote,Descuento,Sub_Total,Monto_Descuento,Lote = JSON_QUERY((SELECT  Id_Lote,Id_Producto,Precio_Venta,Precio_Compra,Cantidad_Inicial,Cantidad_Existente,Id_Sucursal,Id_User,Fecha_Ingreso,Id_Almacen,Lote,Id_Detalle_Compra,Detalles, Datos_Producto = JSON_QUERY(Datos_Producto), EtiquetaLote = JSON_QUERY(EtiquetaLote),Cat_Almacenes = JSON_QUERY((SELECT  Id_Almacen,Descripcion,Estado,Id_Sucursal FROM facturacion.Cat_Almacenes as LNK_L_P_Q   WHERE   Id_Almacen = DCF_C_J_X.Id_Almacen  ORDER BY Id_Almacen DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Detalle_Compra = JSON_QUERY((SELECT  Id_Detalle_Compra,Id_Compra,Id_Producto,Cantidad,Precio_Unitario,SubTotal,Iva,Total,Presentacion FROM facturacion.Detalle_Compra as SGV_Q_M_H   WHERE   Id_Detalle_Compra = DCF_C_J_X.Id_Detalle_Compra  ORDER BY Id_Detalle_Compra DESC FOR JSON PATH,  ROOT('object')),'$.object[0]'),Estado FROM facturacion.Tbl_Lotes as DCF_C_J_X   WHERE Estado = @EstadoQXR_H_O_D  AND   Id_Lote = XZX_A_V_I.Id_Lote  ORDER BY Id_Lote DESC FOR JSON PATH,  ROOT('object')),'$.object[0]') FROM facturacion.Detalle_Factura as XZX_A_V_I   WHERE   Id_Factura = VYD_T_J_Y.Id_Factura  ORDER BY Id_DetalleFactura DESC FOR JSON PATH) FROM facturacion.Tbl_Factura as VYD_T_J_Y     ORDER BY Id_Factura DESC: Must declare the scalar variable "@EstadoQXR_H_O_D".
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at APPCORE.GDatosAbstract.<>c__DisplayClass35_0.<TraerDatosSQL>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 286
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.TraerDatosSQL(String queryString, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 278
   at APPCORE.BDCore.Abstracts.WDataMapper.BuildTable(EntityClass Inst, String& CondSQL, Boolean isSimpleFind) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 548
[5/25/2025 7:15:41 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 7:15:41 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 7:15:41 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 7:15:41 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
[5/25/2025 7:15:49 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 7:15:49 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 7:15:49 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 7:15:49 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
[5/25/2025 8:05:16 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:05:16 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:05:16 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 8:05:16 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
[5/25/2025 8:06:00 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:06:00 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:06:00 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 8:06:00 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
[5/25/2025 8:07:55 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:07:55 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:07:55 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 8:08:17 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
[5/25/2025 8:10:28 PM] ERROR: Max retries reached. Operation failed.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:10:28 PM] Transaction failed and connection restarted.: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
[5/25/2025 8:10:28 PM] ERROR: Save entity: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
[5/25/2025 8:10:28 PM] Error al anular el acta: Cannot insert explicit value for identity column in table 'Tbl_Factura' when IDENTITY_INSERT is set to OFF.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteScalar()
   at APPCORE.GDatosAbstract.<>c__DisplayClass28_0.<ExcuteSqlQuery>b__0() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 170
   at APPCORE.GDatosAbstract.ExecuteWithRetry(Func`1 operation, Int32 maxRetries) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 234
   at APPCORE.GDatosAbstract.ExcuteSqlQuery(String strQuery, IDbConnection dbConnection, IDbTransaction dbTransaction, List`1 parameters) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\Abstracts\GDatosAbstract.cs:line 164
   at APPCORE.BDCore.Abstracts.WDataMapper.InsertObject(EntityClass entity) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\BDCore\DataMapper.cs:line 51
   at APPCORE.EntityClass.Save() in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\AppCore\Data_Access\EntityStructure\EntityClass.cs:line 175
   at UI.CAPA_NEGOCIO.Facturacion.Operations.FacturacionServices.DoSaveFactura(String Identity, Tbl_Factura factura) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Operations\FacturacionServices.cs:line 208
   at BusinessLogic.Facturacion.Mapping.ReturnTransaction.Execute(String Identify) in C:\Users\wilbe\repos\NETCORE\EmpresaUpdated\BusinessLogic\Facturacion\Mapping\ReturnTransaction.cs:line 64
